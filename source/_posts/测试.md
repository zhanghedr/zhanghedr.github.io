---
title: 测试浅谈
date: 2018-06-10 00:37:06
categories: Tech
---

测试驱动开发TDD(Test-Driven Development)是敏捷开发(Agile Development)中的一项方法论，TDD的原理是在开发代码之前，先编写单元测试代码，虽然我理解大部分场景是做不到这一点的，但是自测还是很有必要。它的优点是保证代码质量减少BUG，同时明确了需求并想好了代码的设计思路，缺点是时间成本太高。

<!-- more -->

## 单元测试

指对系统中的最小单元进行测试，如方法和类，保证每个模块和预期一致，并能在前期就发现问题。常用的框架是JUnit，分为setUp、@Test、@tearDown三步，有下面几个原则：

- 测试方法独立
- 依赖数据用Mock构造，常见框架有Mockito
- 监控测试指标代码覆盖率，常见框架有JaCoCo
- Assert断言测试结果
- 覆盖主干链路和边界条件
- 测试代码尽可能简洁，维护成本低

根据常见的层级，可以分为：

- DAO层：准备库测试数据，测试完成后删除测试数据
- Service层：Mock依赖服务接口数据，验证自己服务结果
- Controller层：Mock依赖服务接口数据，验证入参和返回值

## 集成测试

借助于如Jenkins平台进行持续集成测试，在执行多个单元测试的基础上，进行系统构建。

## 回归测试

修改了旧代码后，重新测试以确认修改没有引入新的错误或导致其他代码产生错误。

## 冒烟测试

在短时间内(1天)，执行测试用例(Test Case)，确保软件基本功能正常，新需求流程能跑通。早期发现问题，确保OK才进行后面的测试。

## 性能测试

主要有负载测试(测试系统在设计负载下的性能)和压力测试(测试系统在极限负载下的性能)。

## 测试痛点

- 环境对齐，保证上下游服务在同一个预期的环境上可用
- 测试数据，保证自身和依赖有足够的测试数据可用
- 并行测试，保证在多个需求同时开发和测试时，能提供每个需求独立隔离的测试环境，不会互相干扰影响

## 代码质量

- **原则：开发前充分理解需求做好技术方案，开发中保持良好Code Style，开发后做好自测，上线前做好CodeReview**
- **工具：Alibaba Java Coding Guidelines(IDEA代码扫描插件) + Jenkins(持续集成) + JUnit(单元测试) + JaCoCo(代码覆盖率) + SonarQube(静态代码扫描)**
- **进阶：进行性能测试，寻找潜在BUG和可优化点**